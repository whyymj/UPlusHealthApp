webpackJsonp([30],{lapH:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Xxa5"),i=a.n(s),n=a("exGp"),c=a.n(n),r=a("mtWM"),o=a.n(r),l=a("Au9i"),d={name:"associationRequest",data:function(){return{visible:!1,characterValue:"",message:"",pickerValue:{},dateSlots:[]}},mounted:function(){this.getUserById(),this.getRelationList()},methods:{getUserById:function(){var t=this;return c()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.post("/api/user/info",{phone:""});case 3:"C0000"===(a=e.sent).data.code&&(t.message="我是"+(a.data.data.nick_name?a.data.data.nick_name:a.data.data.login_code)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("err: ",e.t0);case 10:case"end":return e.stop()}},e,t,[[0,7]])}))()},getRelationList:function(){var t=this;return c()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.a.get("/api/relation");case 3:"C0000"===(a=e.sent).data.code&&(a.data.data.splice(a.data.data.indexOf(a.data.data.map(function(t){return"13"===t.dict_id}),1)),t.dateSlots=[{flex:1,values:a.data.data,className:"slot1",textAlign:"center"}],t.pickerValue=a.data.data[0]),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}},e,t,[[0,7]])}))()},showCharacter:function(){this.visible=!0},onChange:function(t,e){this.pickerValue=e[0]},confirm:function(){this.characterValue=this.pickerValue.dict_name,this.visible=!1},sendRequest:function(){var t=this;return c()(i.a.mark(function e(){var a,s,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==t.message&&""!==t.characterValue){e.next=3;break}return Object(l.Toast)({message:"信息不全"}),e.abrupt("return");case 3:return a={receive_code:t.$route.params.phone,message:t.message,association:t.pickerValue.dict_id},e.prev=4,e.next=7,o.a.post("/api/associate",a);case 7:s=e.sent,n=t,"C0000"===s.data.code?Object(l.Toast)({message:"请求发送成功",duration:2e3}):Object(l.Toast)({message:s.data.data.msg,duration:2e3}),setTimeout(function(){n.$router.push({path:"/familyManagement"})},2e3),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(4),Object(l.Toast)({message:"网络有问题!",className:"no-results",duration:2e3}),console.log("Whoops: ",e.t0);case 17:case"end":return e.stop()}},e,t,[[4,13]])}))()}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page associated-request"},[a("div",{staticClass:"container white-bg has-footer"},[a("div",{staticClass:"space"}),t._v(" "),a("div",{staticClass:"tip"},[t._v("您需要发送验证申请，等待对方通过")]),t._v(" "),a("div",{staticClass:"send-msg"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],attrs:{type:"text",placeholder:"请输入"},domProps:{value:t.message},on:{input:function(e){e.target.composing||(t.message=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"select-character clearfix",on:{click:t.showCharacter}},[a("div",{staticClass:"float-left"},[t._v("亲友关系")]),t._v(" "),a("div",{staticClass:"float-right"},[a("span",[t._v(t._s(t.characterValue))]),a("i",{staticClass:"fa fa-angle-right"})])]),t._v(" "),t._m(0)]),t._v(" "),a("div",{staticClass:"footer"},[a("button",{staticClass:"associated text-center",on:{click:t.sendRequest}},[t._v("发送请求")])]),t._v(" "),a("mt-popup",{staticClass:"mint-datetime",attrs:{closeOnClickModal:!0,position:"bottom"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("mt-picker",{staticClass:"mint-datetime-picker",attrs:{slots:t.dateSlots,"value-key":"dict_name","show-toolbar":""},on:{change:t.onChange}},[a("span",{staticClass:"mint-datetime-action mint-datetime-cancel",on:{click:function(e){t.visible=!1}}},[t._v("取消")]),t._v(" "),a("span",{staticClass:"mint-datetime-action mint-datetime-confirm",on:{click:t.confirm}},[t._v("确定")])])],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"notification"},[e("h3",[this._v("提示")]),this._v(" "),e("div",{staticClass:"first-text"},[this._v("1.添加亲友后可以查看对方健康数据；")]),this._v(" "),e("div",[this._v("2.除查看数据外，您无法对亲友进行其他操作；")])])}]};var v=a("VU/8")(d,u,!1,function(t){a("ymgw")},"data-v-2d976224",null);e.default=v.exports},ymgw:function(t,e){}});
//# sourceMappingURL=30.038c815d1eb9c75bfd9b.js.map